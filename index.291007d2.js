const t=new class{constructor(t){this.status="idle";let e=t||[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]];this.init=structuredClone(e),this.state=structuredClone(e),this.score=0}moveLeft(){let t=structuredClone(this.state);for(let t=0;t<this.state.length;t++){let e=[];for(let s=0;s<this.state.length;s++)e.push(this.state[t][s]);let s=e.filter(t=>0!==t);for(let t=0;t<s.length-1;t++)s[t]===s[t+1]&&(s[t]*=2,this.score+=s[t],s[t+1]=0,t++);for(s=s.filter(t=>0!==t);s.length<this.state.length;)s.push(0);for(let e=0;e<this.state.length;e++)this.state[t][e]=s[e]}for(let e=0;e<4;e++)for(let s=0;s<4;s++)if(t[e][s]!==this.state[e][s])return!0;return!1}moveRight(){let t=structuredClone(this.state);for(let t=0;t<this.state.length;t++){let e=[];for(let s=0;s<this.state.length;s++)e.push(this.state[t][s]);let s=e.filter(t=>0!==t);for(let t=0;t<s.length-1;t++)s[t]===s[t+1]&&(s[t]*=2,this.score+=s[t],s[t+1]=0,t++);for(s=s.filter(t=>0!==t);s.length<this.state.length;)s.unshift(0);for(let e=0;e<this.state.length;e++)this.state[t][e]=s[e]}for(let e=0;e<4;e++)for(let s=0;s<4;s++)if(t[e][s]!==this.state[e][s])return!0;return!1}moveUp(){let t=structuredClone(this.state);for(let t=0;t<this.state.length;t++){let e=[];for(let s=0;s<this.state.length;s++)e.push(this.state[s][t]);let s=e.filter(t=>0!==t);for(let t=0;t<s.length-1;t++)s[t]===s[t+1]&&(s[t]*=2,this.score+=s[t],s[t+1]=0,t++);for(s=s.filter(t=>0!==t);s.length<this.state.length;)s.push(0);for(let e=0;e<this.state.length;e++)this.state[e][t]=s[e]}for(let e=0;e<4;e++)for(let s=0;s<4;s++)if(t[e][s]!==this.state[e][s])return!0;return!1}moveDown(){let t=structuredClone(this.state);for(let t=0;t<this.state.length;t++){let e=[];for(let s=0;s<this.state.length;s++)e.push(this.state[s][t]);let s=e.filter(t=>0!==t);for(let t=0;t<s.length-1;t++)s[t]===s[t+1]&&(s[t]*=2,this.score+=s[t],s[t+1]=0,t++);for(s=s.filter(t=>0!==t);s.length<this.state.length;)s.unshift(0);for(let e=0;e<this.state.length;e++)this.state[e][t]=s[e]}for(let e=0;e<4;e++)for(let s=0;s<4;s++)if(t[e][s]!==this.state[e][s])return!0;return!1}getScore(){return this.score}getState(){return this.state}getStatus(){return this.status}start(){let t=this.state.flat().filter(t=>0!==t).length;for(;t<2;)this.addNewTile(),t=this.state.flat().filter(t=>0!==t).length;this.updateUI(),this.status="playing"}restart(){let t=this.state.flat().filter(t=>0!==t).length;this.state=t>0?structuredClone([[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]]):structuredClone(this.init),this.score=0,this.updateUI(),this.status="idle"}addNewTile(){let t=[];for(let e=0;e<this.state.length;e++)for(let s=0;s<this.state.length;s++)0===this.state[e][s]&&t.push({row:e,col:s});if(0===t.length)return;let{row:e,col:s}=t[Math.floor(Math.random()*t.length)];this.state[e][s]=.9>Math.random()?2:4}updateUI(){let t=document.querySelectorAll(".field-row");for(let e=0;e<this.state.length;e++){let s=t[e].querySelectorAll(".field-cell");for(let t=0;t<this.state.length;t++){let r=this.state[e][t];s[t].className=`field-cell${r?` field-cell--${r}`:""}`,s[t].textContent=r||""}}}hasNoMoves(){let t=this.state,e=this.state.length;for(let s=0;s<e;s++)for(let r=0;r<e;r++)if(0===t[s][r]||r<e-1&&t[s][r]===t[s][r+1]||s<e-1&&t[s][r]===t[s+1][r])return!1;return!0}has2048Tile(){return this.state.flat().some(t=>2048===t)}checkGameOver(){this.hasNoMoves()&&(this.status="lose"),this.has2048Tile()&&(this.status="win")}},e=document.querySelector("button"),s=document.querySelector(".game-score");e.addEventListener("click",r=>{"idle"===t.getStatus()?(e.classList.remove("start"),e.classList.add("restart"),e.textContent="Restart",document.querySelector(".message-start").classList.add("hidden"),t.start()):(e.classList.remove("restart"),e.classList.add("start"),e.textContent="Start",s.textContent="0",document.querySelector(".message-start").classList.remove("hidden"),document.querySelector(".message-lose").classList.add("hidden"),document.querySelector(".message-win").classList.add("hidden"),t.restart())}),document.addEventListener("keydown",e=>{if("playing"===t.getStatus()){let r=!1;switch(e.key){case"ArrowUp":r=t.moveUp();break;case"ArrowDown":r=t.moveDown();break;case"ArrowLeft":r=t.moveLeft();break;case"ArrowRight":r=t.moveRight()}r&&(t.addNewTile(),t.updateUI(),t.checkGameOver(),s.textContent=t.getScore(),"lose"===t.getStatus()?document.querySelector(".message-lose").classList.remove("hidden"):document.querySelector(".message-lose").classList.add("hidden"),"win"===t.getStatus()?document.querySelector(".message-win").classList.remove("hidden"):document.querySelector(".message-win").classList.add("hidden"))}});
//# sourceMappingURL=index.291007d2.js.map
