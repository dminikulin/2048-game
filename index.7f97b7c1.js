var t,e,r;t=new/*#__PURE__*/(function(){var t;function e(t){(function(t,e){if(!(t instanceof e))throw TypeError("Cannot call a class as a function")})(this,e),this.status="idle";var r=t||[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]];this.init=structuredClone(r),this.state=structuredClone(r),this.score=0}return t=[{key:"moveLeft",value:function(){for(var t=this,e=structuredClone(this.state),r=0;r<this.state.length;r++)!function(e){for(var r=[],s=0;s<t.state.length;s++)r.push(t.state[e][s]);for(var n=r.filter(function(t){return 0!==t}),a=0;a<n.length-1;a++)n[a]===n[a+1]&&(n[a]*=2,t.score+=n[a],n[a+1]=0,a++);for(n=n.filter(function(t){return 0!==t});n.length<t.state.length;)n.push(0);for(var o=0;o<t.state.length;o++)t.state[e][o]=n[o]}(r);for(var s=0;s<4;s++)for(var n=0;n<4;n++)if(e[s][n]!==this.state[s][n])return!0;return!1}},{key:"moveRight",value:function(){for(var t=this,e=structuredClone(this.state),r=0;r<this.state.length;r++)!function(e){for(var r=[],s=0;s<t.state.length;s++)r.push(t.state[e][s]);for(var n=r.filter(function(t){return 0!==t}),a=0;a<n.length-1;a++)n[a]===n[a+1]&&(n[a]*=2,t.score+=n[a],n[a+1]=0,a++);for(n=n.filter(function(t){return 0!==t});n.length<t.state.length;)n.unshift(0);for(var o=0;o<t.state.length;o++)t.state[e][o]=n[o]}(r);for(var s=0;s<4;s++)for(var n=0;n<4;n++)if(e[s][n]!==this.state[s][n])return!0;return!1}},{key:"moveUp",value:function(){for(var t=this,e=structuredClone(this.state),r=0;r<this.state.length;r++)!function(e){for(var r=[],s=0;s<t.state.length;s++)r.push(t.state[s][e]);for(var n=r.filter(function(t){return 0!==t}),a=0;a<n.length-1;a++)n[a]===n[a+1]&&(n[a]*=2,t.score+=n[a],n[a+1]=0,a++);for(n=n.filter(function(t){return 0!==t});n.length<t.state.length;)n.push(0);for(var o=0;o<t.state.length;o++)t.state[o][e]=n[o]}(r);for(var s=0;s<4;s++)for(var n=0;n<4;n++)if(e[s][n]!==this.state[s][n])return!0;return!1}},{key:"moveDown",value:function(){for(var t=this,e=structuredClone(this.state),r=0;r<this.state.length;r++)!function(e){for(var r=[],s=0;s<t.state.length;s++)r.push(t.state[s][e]);for(var n=r.filter(function(t){return 0!==t}),a=0;a<n.length-1;a++)n[a]===n[a+1]&&(n[a]*=2,t.score+=n[a],n[a+1]=0,a++);for(n=n.filter(function(t){return 0!==t});n.length<t.state.length;)n.unshift(0);for(var o=0;o<t.state.length;o++)t.state[o][e]=n[o]}(r);for(var s=0;s<4;s++)for(var n=0;n<4;n++)if(e[s][n]!==this.state[s][n])return!0;return!1}},{key:"getScore",value:function(){return this.score}},{key:"getState",value:function(){return this.state}},{key:"getStatus",value:function(){return this.status}},{key:"start",value:function(){for(var t=this.state.flat().filter(function(t){return 0!==t}).length;t<2;)this.addNewTile(),t=this.state.flat().filter(function(t){return 0!==t}).length;this.updateUI(),this.status="playing"}},{key:"restart",value:function(){var t=this.state.flat().filter(function(t){return 0!==t}).length;this.state=t>0?structuredClone([[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]]):structuredClone(this.init),this.score=0,this.updateUI(),this.status="idle"}},{key:"addNewTile",value:function(){for(var t=[],e=0;e<this.state.length;e++)for(var r=0;r<this.state.length;r++)0===this.state[e][r]&&t.push({row:e,col:r});if(0!==t.length){var s=t[Math.floor(Math.random()*t.length)],n=s.row,a=s.col;this.state[n][a]=.9>Math.random()?2:4}}},{key:"updateUI",value:function(){for(var t=document.querySelectorAll(".field-row"),e=0;e<this.state.length;e++)for(var r=t[e].querySelectorAll(".field-cell"),s=0;s<this.state.length;s++){var n=this.state[e][s];r[s].className="field-cell".concat(n?" field-cell--".concat(n):""),r[s].textContent=n||""}}},{key:"hasNoMoves",value:function(){for(var t=this.state,e=this.state.length,r=0;r<e;r++)for(var s=0;s<e;s++)if(0===t[r][s]||s<e-1&&t[r][s]===t[r][s+1]||r<e-1&&t[r][s]===t[r+1][s])return!1;return!0}},{key:"has2048Tile",value:function(){return this.state.flat().some(function(t){return 2048===t})}},{key:"checkGameOver",value:function(){this.hasNoMoves()&&(this.status="lose"),this.has2048Tile()&&(this.status="win")}}],function(t,e){for(var r=0;r<e.length;r++){var s=e[r];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}(e.prototype,t),e}()),e=document.querySelector("button"),r=document.querySelector(".game-score"),e.addEventListener("click",function(s){"idle"===t.getStatus()?(e.classList.remove("start"),e.classList.add("restart"),e.textContent="Restart",document.querySelector(".message-start").classList.add("hidden"),t.start()):(e.classList.remove("restart"),e.classList.add("start"),e.textContent="Start",r.textContent="0",document.querySelector(".message-start").classList.remove("hidden"),document.querySelector(".message-lose").classList.add("hidden"),document.querySelector(".message-win").classList.add("hidden"),t.restart())}),document.addEventListener("keydown",function(e){if("playing"===t.getStatus()){var s=!1;switch(e.key){case"ArrowUp":s=t.moveUp();break;case"ArrowDown":s=t.moveDown();break;case"ArrowLeft":s=t.moveLeft();break;case"ArrowRight":s=t.moveRight()}s&&(t.addNewTile(),t.updateUI(),t.checkGameOver(),r.textContent=t.getScore(),"lose"===t.getStatus()?document.querySelector(".message-lose").classList.remove("hidden"):document.querySelector(".message-lose").classList.add("hidden"),"win"===t.getStatus()?document.querySelector(".message-win").classList.remove("hidden"):document.querySelector(".message-win").classList.add("hidden"))}});
//# sourceMappingURL=index.7f97b7c1.js.map
